import difflib

# Read the template file and existing test case file
with open('template.py', 'r') as template_file, open('test_case.py', 'r') as test_case_file:
    template_lines = template_file.readlines()
    test_case_lines = test_case_file.readlines()

# Create a differ object
differ = difflib.Differ()

# Compute the differences between the two files
diff = list(differ.compare(template_lines, test_case_lines))

# Define a function to filter lines that should not be added
def should_add(line):
    # Add custom logic here to determine if a line should be added or not
    # For example, skip lines starting with "import" and lines containing parameterized variables
    return not line.startswith('import ') and not ('{' in line or '}' in line)

# Merge the lines from the template into the test case
merged_lines = []
add_next_line = False  # Flag to handle multiline variable values
for line in diff:
    if line.startswith('  '):
        # Lines present in both files, add to merged lines
        if not add_next_line:
            merged_lines.append(line[2:])
        else:
            # Handle multiline variable values
            merged_lines[-1] += line[2:]
            add_next_line = False
    elif line.startswith('- ') and should_add(line[2:]):
        # Lines present in the test case but not in the template, add to merged lines
        merged_lines.append(line[2:])
        if line[2:].endswith('{') or line[2:].endswith('"""{') or line[2:].endswith("'{"):
            # Flag to indicate that the next line should be added
            add_next_line = True

# Write the updated test case file
with open('test_case.py', 'w') as test_case_file:
    test_case_file.writelines(merged_lines)
