pattern = re.compile(rf'({column}\s*=\s*)[^\s,]+')
python_code = pattern.sub(lambda match: update_method_parameter(match.group(), 'method_param1', excel_value), python_code)



# Function to update a specific method parameter value in a method call
def update_method_parameter(method_call, param_name, new_value):
    # Regular expression to match the parameter and its value
    pattern = re.compile(rf'({param_name}\s*=\s*)[^\s,]+')

    # Update the parameter value in the method call
    updated_method_call = pattern.sub(fr'\1"{new_value}"', method_call)

    return updated_method_call







def update_test_case(python_code, variable_mapping, method_param_mapping):
    for var_name, var_value in variable_mapping.items():
        python_code = python_code.replace(f'{{{var_name}}}', var_value)
    
    for param_name, param_value in method_param_mapping.items():
        pattern = re.compile(rf'({param_name}\s*=\s*)[^\s,]+')
        python_code = pattern.sub(fr'\1"{param_value}"', python_code)
    
    return python_code


pattern = re.compile(rf'({param_name}\s*=\s*)([^,\s]+)')
    
updated_method_call = pattern.sub(fr'\1{new_value}', method_call)






import pandas as pd
from collections import Counter

# Sample lists with potential duplicates
variable_names = ['var1', 'var2', 'var1', 'var3']
method_params = ['param1', 'param2', 'param1', 'param3']

# Count occurrences of each variable/method
variable_counts = Counter(variable_names)
method_counts = Counter(method_params)

# Create a DataFrame with unique column names
df = pd.DataFrame({f'{name}_{i+1}' if count > 1 else name: [] for name, count in variable_counts.items()})
df.update(pd.DataFrame({f'{name}_{i+1}' if count > 1 else name: [] for name, count in method_counts.items()}))

print(df.columns.tolist())  # Print column names

