pattern = re.compile(rf'({column}\s*=\s*)[^\s,]+')
python_code = pattern.sub(lambda match: update_method_parameter(match.group(), 'method_param1', excel_value), python_code)



# Function to update a specific method parameter value in a method call
def update_method_parameter(method_call, param_name, new_value):
    # Regular expression to match the parameter and its value
    pattern = re.compile(rf'({param_name}\s*=\s*)[^\s,]+')

    # Update the parameter value in the method call
    updated_method_call = pattern.sub(fr'\1"{new_value}"', method_call)

    return updated_method_call







def update_test_case(python_code, variable_mapping, method_param_mapping):
    for var_name, var_value in variable_mapping.items():
        python_code = python_code.replace(f'{{{var_name}}}', var_value)
    
    for param_name, param_value in method_param_mapping.items():
        pattern = re.compile(rf'({param_name}\s*=\s*)[^\s,]+')
        python_code = pattern.sub(fr'\1"{param_value}"', python_code)
    
    return python_code


pattern = re.compile(rf'({param_name}\s*=\s*)([^,\s]+)')
    
updated_method_call = pattern.sub(fr'\1{new_value}', method_call)






import pandas as pd
from collections import Counter

# Sample lists with potential duplicates
variable_names = ['var1', 'var2', 'var1', 'var3']
method_params = ['param1', 'param2', 'param1', 'param3']

# Combine the lists and count occurrences
all_names = variable_names + method_params
name_counts = Counter(all_names)

# Modify the column names to add a suffix only for duplicates
column_names = []
for name, count in name_counts.items():
    if count > 1:
        column_names.extend([f'{name} ({i+1})' for i in range(count)])
    else:
        column_names.append(name)

# Create a DataFrame with modified column names
df = pd.DataFrame({name: [] for name in column_names})

# Write to Excel with modified column names
excel_file_path = 'output.xlsx'
df.to_excel(excel_file_path, index=False)

print('DataFrame saved to Excel with modified column names.')



